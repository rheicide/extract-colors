"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t='!function(){"use strict";class t{constructor(t,s,i,h=t<<16|s<<8|i){this.t=1,this.i=-1,this.h=-1,this.o=-1,this.u=-1,this.l=t,this.M=s,this.C=i,this.p=h}static distance(t,s){return(Math.abs(s.l-t.l)+Math.abs(s.M-t.M)+Math.abs(s.C-t.C))/765}clone(){const s=new t(this.l,this.M,this.C,this.p);return s.t=this.t,s}m(){const t=this.l/255,s=this.M/255,i=this.C/255,h=Math.max(t,s,i),e=Math.min(t,s,i);if(this.o=(h+e)/2,h===e)this.h=0,this.i=0,this.u=0;else{const n=h-e;switch(this.i=this.o>.5?n/(2-h-e):n/(h+e),this.u=this.i*(2*(.5-Math.abs(.5-this.o))),h){case t:this.h=((s-i)/n+(s<i?6:0))/6;break;case s:this.h=((i-t)/n+2)/6;break;case i:this.h=((t-s)/n+4)/6}}}get v(){return-1===this.h&&this.m(),this.h}get L(){return-1===this.i&&this.m(),this.i}get O(){return-1===this.o&&this.m(),this.o}get _(){return-1===this.u&&this.m(),this.u}}const s=(t,s)=>Math.abs(t-s);class i{constructor(){this.j=[],this.$=null}k(t){this.j.push(t),this.$=null}G(t,i,h,e){for(const a of this.j){if(!(n=a.v,r=t.v,Math.min(s(n,r),s((n+.5)%1,(r+.5)%1))<i&&s(a.L,t.L)<h&&s(a.O,t.O)<e))return!1}var n,r;return!0}get I(){if(!this.$){const{r:s,g:i,b:h}=this.j.reduce(((t,s)=>(t.r+=s.l,t.g+=s.M,t.b+=s.C,t)),{r:0,g:0,b:0}),e=this.j.reduce(((t,s)=>t+s.t),0);this.$=new t(Math.round(s/this.j.length),Math.round(i/this.j.length),Math.round(h/this.j.length)),this.$.t=e}return this.$}}class h{constructor(t,s,i){this.S=[],this.v=t,this.L=s,this.O=i}k(t){const s=this.S.find((s=>s.G(t,this.v,this.L,this.O)));if(s)s.k(t);else{const s=new i;s.k(t),this.S.push(s)}}B(){return this.S.map((t=>t.I))}}class e{constructor(){this.t=0,this.D={}}k(s,i,h,e){return this.t++,this.D[s]?this.D[s].t++:this.D[s]=new t(i,h,e,s),this.D[s]}F(){return Object.keys(this.D).map((t=>this.D[t]))}H(){const t=this.F().reduce(((t,s)=>t.t>=s.t?t:s)).clone();return t.t=this.t,t}}class n{constructor(){this.t=0,this.D={}}F(){return Object.keys(this.D).map((t=>this.D[t]))}k(t,s,i){const h=t<<16|s<<8|i,e=(t>>4&15)<<8|(s>>4&15)<<4|i>>4&15;return this.t++,this.P(e).k(h,t,s,i)}P(t){return this.D[t]||(this.D[t]=new e),this.D[t]}q(s){const i=this.F().map((t=>t.H()));i.sort(((t,s)=>s.t-t.t));const h=[];for(;i.length;){const e=i.shift();i.filter((i=>t.distance(e,i)<s)).forEach((t=>{e.t+=t.t;const s=i.findIndex((s=>s===t));i.splice(s,1)})),h.push(e)}return h}}var r=({data:t,width:s,height:i},h,e,r)=>{const a=new n,o=s&&i&&Math.floor(s*i/h)||1;let c=0;for(let n=0;n<t.length;n+=4*o){const s=t[n],i=t[n+1],h=t[n+2];r(s,i,h,t[n+3])?a.k(s,i,h):c++}return{j:a.q(e),count:a.t+c}};const a=(t,s,i,e,n)=>{const r=((t,s,i,e,n)=>{const r=new h(i,e,n);t.forEach((t=>r.k(t)));const a=r.B();return a.sort(((t,i)=>(i._+.1)*(.9-i.t/s)-(t._+.1)*(.9-t.t/s))),a})(t,s,i,e,n);return r.map((t=>((t,s)=>({hex:`#${"0".repeat(6-t.p.toString(16).length)}${t.p.toString(16)}`,red:t.l,green:t.M,blue:t.C,area:t.t/s,hue:t.v,saturation:t.L,lightness:t.O,intensity:t._}))(t,s)))},o=async(t,s)=>{const[i,h,e,n,o,c]=s,u=((t,s)=>{const i=t.width*t.height,h=i<s?t.width:Math.round(t.width*Math.sqrt(s/i)),e=i<s?t.height:Math.round(t.height*Math.sqrt(s/i)),n=new OffscreenCanvas(h,e).getContext("2d");return n.drawImage(t,0,0,t.width,t.height,0,0,h,e),n.getImageData(0,0,h,e)})(t,i),{j:l,count:g}=r(u,i,h,e);return a(l,g,n,o,c)},c=async(t,s,i)=>{if(t instanceof ImageData||t instanceof Object&&t.data)return i(((t,s)=>{const[i,h,e,n,o,c]=s,{j:u,count:l}=r(t,i,h,e);return a(u,l,n,o,c)})(t,s));if("string"==typeof t)return i(await(async(t,s)=>{const i=await fetch(t,{mode:s[7]}),h=await i.blob(),e=await createImageBitmap(h),n=await o(e,s);return e.close(),n})(t,s));throw new Error("Can not analyse picture")};onmessage=t=>{const[s,[i,h,e,...n]]=t.data;c(s,[i,h,Function(`return ${e}`)(),...n],postMessage)}}();\n//# sourceMappingURL=worker-BpWVVq8n.js.map\n',s="undefined"!=typeof self&&self.Blob&&new Blob(["(self.URL || self.webkitURL).revokeObjectURL(self.location.href);",t],{type:"text/javascript;charset=utf-8"});function e(e){let i;try{if(i=s&&(self.URL||self.webkitURL).createObjectURL(s),!i)throw"";const t=new Worker(i,{name:e?.name});return t.addEventListener("error",(()=>{(self.URL||self.webkitURL).revokeObjectURL(i)})),t}catch(n){return new Worker("data:text/javascript;charset=utf-8,"+encodeURIComponent(t),{name:e?.name})}}exports.extractColors=(t,s)=>{process.env.NODE_ENV !== "production"&&function({pixels:t=64e3,distance:s=.22,colorValidator:e=(t,s,e,i)=>(i??255)>250,hueDistance:i=.08333333333333333,saturationDistance:n=.2,lightnessDistance:h=.2,crossOrigin:r="",requestMode:a="cors"}={}){const o=(t,s,e=0,i=Number.MAX_VALUE)=>{if(Number(s)!==s)throw new Error(`${t} is not a valid number (${s})`);return s<e&&console.warn(`${t} can not be less than ${e} (it's ${s})`),s>i&&console.warn(`${t} can not be more than ${i} (it's ${s})`),Math.min(Math.max(s,e),i)},c=(t,s,e)=>{e.indexOf(s)<0&&console.warn(`${t} can be one of this values ${e.map((t=>`"${t}"`)).join(", ")} (it's "${s}")`)};((t,s,e=0,i=Number.MAX_SAFE_INTEGER)=>{if(!Number.isInteger(s))throw new Error(`${t} is not a valid number (${s})`);s<e&&console.warn(`${t} can not be less than ${e} (it's ${s})`),s>i&&console.warn(`${t} can not be more than ${i} (it's ${s})`),Math.min(Math.max(s,e),i)})("pixels",t||0,1),o("distance",s,0,1),((t,s)=>{if(!s||"[object Function]"!=={}.toString.call(s))throw new Error(`${t} is not a function (${s})`)})("colorValidator",e),o("hueDistance",i,0,1),o("saturationDistance",n,0,1),o("lightnessDistance",h,0,1),c("crossOrigin",r,["","anonymous","use-credentials"]),c("requestMode",a,["cors","navigate","no-cors","same-origin"])}(s),t instanceof HTMLImageElement&&(process.env.NODE_ENV !== "production"&&console.warn("HTMLImageElement not enable on worker, please send 'src' or image data instead HTMLImageElement"),t=t.src);const[i,n,h,...r]=(({pixels:t=64e3,distance:s=.22,colorValidator:e=(t,s,e,i)=>(i??255)>250,hueDistance:i=.08333333333333333,saturationDistance:n=.2,lightnessDistance:h=.2,crossOrigin:r="",requestMode:a="cors"}={})=>[Math.max(t,1),Math.min(Math.max(s,0),1),e,Math.min(Math.max(i,0),1),Math.min(Math.max(n,0),1),Math.min(Math.max(h,0),1),r,a])(s);return new Promise(((s,a)=>{try{const o=new e;o.postMessage([t,[i,n,h.toString(),...r]]),o.addEventListener("message",(t=>{s(t.data),o.terminate()})),o.addEventListener("error",(t=>{a(t),o.terminate()}))}catch(o){a(o)}}))};
//# sourceMappingURL=worker-wrapper.cjs.map
